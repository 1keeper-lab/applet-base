const a0_0x27f8a9=a0_0x1ebb;function a0_0x1ebb(_0x509765,_0x560865){const _0x3e6dbf=a0_0x3e6d();return a0_0x1ebb=function(_0x1ebb05,_0x4046cc){_0x1ebb05=_0x1ebb05-0x6a;let _0x47596c=_0x3e6dbf[_0x1ebb05];return _0x47596c;},a0_0x1ebb(_0x509765,_0x560865);}(function(_0x5dbe61,_0x1292de){const _0x1ea579=a0_0x1ebb,_0x58d2c0=_0x5dbe61();while(!![]){try{const _0x225a6a=-parseInt(_0x1ea579(0x84))/0x1+parseInt(_0x1ea579(0x7c))/0x2+parseInt(_0x1ea579(0x6c))/0x3+parseInt(_0x1ea579(0x93))/0x4+-parseInt(_0x1ea579(0x97))/0x5*(-parseInt(_0x1ea579(0x87))/0x6)+parseInt(_0x1ea579(0x70))/0x7+-parseInt(_0x1ea579(0x9b))/0x8*(parseInt(_0x1ea579(0x99))/0x9);if(_0x225a6a===_0x1292de)break;else _0x58d2c0['push'](_0x58d2c0['shift']());}catch(_0xaf95f3){_0x58d2c0['push'](_0x58d2c0['shift']());}}}(a0_0x3e6d,0x7eb8a));function a0_0x3e6d(){const _0x1481e0=['applet-base','\x22,\x22appid\x22:\x22','log','34494kRUXiz','\x1b[31m%s\x1b[0m','server','\x22,\x22name\x22:\x22','&hash=','Upload\x20error\x20','build','version','574029BHjbrR','data','code','24BQtWSG','msg','generate','\x1b[36m%s\x1b[0m','path','write','sep','Release\x20success.\x20you\x20can\x20use\x201keeper\x20to\x20scan\x20the\x20QR\x20code\x20below\x20to\x20open\x20the\x20access\x20application\x20\x0a','crypto','Authorization\x20timeout','\x0auploading...\x0a','parse','1784540QBaaFr','/v1/applet/publish/code?appid=','readFileSync','Please\x20login\x20to\x20the\x201Keeper\x20app\x20with\x20your\x20mobile\x20phone,\x20and\x20then\x20use\x20your\x20camera\x20to\x20scan\x20the\x20QR\x20code\x20for\x20authorization.','877685WzBIAf','digest','16668684BOsTOE','/v1/applet/publish','8yirnaK','name','request','hex','multipart/form-data','2736876ktIMOc','GET','sha256','application/json','6071331hqUlAq','createReadStream','qrcode-terminal','.zip','\x1b[32m%s\x1b[0m','appid','node_modules','../../','update'];a0_0x3e6d=function(){return _0x1481e0;};return a0_0x3e6d();}const fs=require('fs'),path=require(a0_0x27f8a9(0x8b)),qrcode=require(a0_0x27f8a9(0x72)),request=require(a0_0x27f8a9(0x9d)),{createHash}=require(a0_0x27f8a9(0x8f)),sep=path[a0_0x27f8a9(0x8d)],rootDir=path['resolve'](__dirname,a0_0x27f8a9(0x77)),appJsPath=rootDir+sep+'app.json',app=require(appJsPath),AppRoot=a0_0x27f8a9(0x82)+sep+app['appid'],ZipFile=AppRoot+a0_0x27f8a9(0x73),server=require(rootDir+sep+a0_0x27f8a9(0x76)+sep+a0_0x27f8a9(0x79)+sep+'package.json')[a0_0x27f8a9(0x7e)];async function main(){const _0x35eb18=a0_0x27f8a9,_0x3ed4ca=createHash(_0x35eb18(0x6e))[_0x35eb18(0x78)](fs[_0x35eb18(0x95)](ZipFile))[_0x35eb18(0x98)](_0x35eb18(0x6a)),_0x4ac0e2=app[_0x35eb18(0x75)],_0x24687b=app['version'],_0xc70103=await postJson(server+_0x35eb18(0x94)+_0x4ac0e2+_0x35eb18(0x80)+_0x3ed4ca+'&version='+_0x24687b);if(_0xc70103['code']!='0')throw Error(_0xc70103[_0x35eb18(0x88)]);const _0x475163=_0xc70103[_0x35eb18(0x85)];qrcode[_0x35eb18(0x89)]('{\x22action\x22:\x22upload\x22,\x22code\x22:\x22'+_0x475163+_0x35eb18(0x7f)+app[_0x35eb18(0x9c)]+'\x22,\x22version\x22:\x22'+app[_0x35eb18(0x83)]+_0x35eb18(0x7a)+app['appid']+'\x22}',{'small':!![]},function(_0x29d227){console['log'](_0x29d227);}),await wait(0x12c),console[_0x35eb18(0x7b)](_0x35eb18(0x8a),_0x35eb18(0x96)),await wait(0x12c);const _0x93a31e=process['stdout'];_0x93a31e[_0x35eb18(0x8c)]('\x0achecking.');var _0x44623e=!![];while(_0x44623e){try{await wait(0x3e8),_0x93a31e[_0x35eb18(0x8c)]('.');const _0x33e849=await postJson(server+'/v1/applet/publish/code/status?code='+_0x475163);_0x33e849[_0x35eb18(0x86)]=='0'?_0x33e849[_0x35eb18(0x85)]==!![]&&(_0x44623e=![],_0x93a31e[_0x35eb18(0x8c)]('\x0a'),upload(_0x475163)):(_0x44623e=![],_0x93a31e[_0x35eb18(0x8c)]('\x0a'),console['log'](_0x35eb18(0x7d),_0x35eb18(0x90)));}catch(_0x31e5b5){}}}async function upload(_0x192123){const _0x11c061=a0_0x27f8a9;console[_0x11c061(0x7b)](_0x11c061(0x91));const _0x49804b=fs[_0x11c061(0x71)](ZipFile),_0x307c38={'url':server+_0x11c061(0x9a),'method':'POST','headers':{'code':_0x192123,'Content-Type':_0x11c061(0x6b)},'formData':{'file':{'value':_0x49804b,'options':{'filename':null,'contentType':null}}}};request(_0x307c38,(_0x514fce,_0x5078dc,_0x1e1c99)=>{const _0x3f7bc4=_0x11c061;var _0x295b26=JSON[_0x3f7bc4(0x92)](_0x1e1c99);_0x295b26[_0x3f7bc4(0x86)]=='0'?(console[_0x3f7bc4(0x7b)](_0x3f7bc4(0x74),_0x3f7bc4(0x8e)),qrcode[_0x3f7bc4(0x89)](_0x295b26['data'],{'small':!![]},function(_0x109cd0){console['log'](_0x109cd0);})):console['log'](_0x3f7bc4(0x7d),_0x3f7bc4(0x81)+_0x295b26['msg']+'\x20\x0a');});}async function wait(_0x12fbb5){return new Promise(_0x337a0e=>setTimeout(()=>_0x337a0e(),_0x12fbb5));}async function postJson(_0x159a78){return new Promise(_0x4835e2=>{const _0x1360e0=a0_0x1ebb,_0x3491b6={'url':_0x159a78,'method':_0x1360e0(0x6d),'headers':{'Content-Type':_0x1360e0(0x6f)}};request(_0x3491b6,(_0x458902,_0x208f9d,_0x546000)=>{const _0x4ecffa=_0x1360e0;_0x4835e2(JSON[_0x4ecffa(0x92)](_0x546000));});});}main();